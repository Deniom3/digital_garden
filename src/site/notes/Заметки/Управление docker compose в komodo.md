---
{"dg-publish":true,"permalink":"/zametki/upravlenie-docker-compose-v-komodo/","created":"2025-11-26 21:08","updated":"2025-11-27T00:13:31+03:00"}
---

[[Заметки/Self-hosting. Komodo\|Komodo]] поддерживает несколько вариант работы с docker compose: хранение в базе komodo (аналог запуска стеков из [[Заметки/Self-hosting. Portainer\|Portainer]]), хранение в репозитории и хранение на сервере в файловой системе.

> [!note]
> Для удобства отбора и поиска удобно применять теги которые созданы по серверам.
### Особенности наименования

В рамках одного экземпляра komodo (не сервера) должна соблюдаться уникальность имен для стеков. При этом при запуске стека будет использовано именно имя указанное как имя стека в komodo. В свою очередь если стек будет перезапущен через ssh или vs code либо любой другой способ для именно стека используется имя папки размещения.

Существую три варианта решения:
- Изменить наименование папки на сервере в соответствии с именем стека
- Установить имя в docker compose для стека через параметр `name` указав туда имя стека в komodo
- Использовать механизм komodo - `project name` 

Я использую вариант с project name как наиболее удобный, устанавливаю имя проекта как имя папки размещения стека.
### Настройка стека в режиме файловой системы

Я использую в основном вариант с хранение в файлах на сервере, этот способ позволяет легко управлять стеками как из ssh подключения так и из komodo с сохранением всего функционала.

![Управление docker compose в komodo-1.png](/img/user/%D0%98%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D0%B8%D0%BA%D0%B8/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20docker%20compose%20%D0%B2%20komodo-1.png)

Обязательными для заполнения являются:
- `Run Directory` - путь к папке где размещается docker compose файл
- `File Paths` - имя файла docker compose, по умолчанию compose.yaml и может не заполняться. Можно указать несколько файлов в том числе `override` для [[Заметки/Дополнение и объединение docker compose файлов\|дополнения основного файла docker compose]].
- `Additional Env Files` - имя файла с переменными окружения, если необходимо использовать то заполнять именем `.env`

На закладке `Info` можно просматривать и изменять файлы запуска и инициировать новые файлы. Если используется docker вариант подключения сервера то файлы будут созданы под именем пользователя который указан в параметрах.

### Настройка обновления

Для автоматического обновления достаточно используется служба обновления по расписанию. Для каждого конкретного стека необходимо включить необходимость обновления.

Существуют два режима:
- `Poll for Updates` - проверка наличия обновления без самого обновления стека
- `Auto update` - обновление стека

Служба обновления настраивается в разделе `Procedures`
![Управление docker compose в komodo-2.png](/img/user/%D0%98%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D0%B8%D0%BA%D0%B8/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20docker%20compose%20%D0%B2%20komodo-2.png)
Для включения необходимо настроить расписание:
![Управление docker compose в komodo-3.png](/img/user/%D0%98%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D0%B8%D0%BA%D0%B8/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20docker%20compose%20%D0%B2%20komodo-3.png)
И настроить этапы задачи:
![Управление docker compose в komodo-4.png](/img/user/%D0%98%D1%81%D1%85%D0%BE%D0%B4%D0%BD%D0%B8%D0%BA%D0%B8/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%20docker%20compose%20%D0%B2%20komodo-4.png)

---
> [!urls]- Упоминания:
> - 